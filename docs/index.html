<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>nowcastlib API documentation</title>
<meta name="description" content="Nowcast Library …" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Package <code>nowcastlib</code></h1>
</header>
<section id="section-intro">
<h1 id="nowcast-library">Nowcast Library</h1>
<p>🧙‍♂️🔧 Utils that can be reused and shared across and beyond the ESO Nowcast
project</p>
<p>This is a public repository hosted on GitHub via a push mirror setup in the
<a href="https://gitlab.eso.org/gstarace/nowcastlib/">internal ESO GitLab repository</a></p>
<h2 id="installation">Installation</h2>
<p>Simply run</p>
<pre><code class="language-console">pip install nowcastlib
</code></pre>
<h2 id="usage-and-documentation">Usage and Documentation</h2>
<p>Nowcast Library (nowcastlib) consists in a collection of functions organized in
submodules (API) and a tool accessible via the command line (CLI). The latter is
primarily intended for accessing the Nowcast Library Pipeline, an opinionated
yet configurable set of processing steps for wrangling data and evaluating
models in a consistent and rigorous way. More information can be found on the
nowcastlib pipeline index page
(<a href="nowcastlib/pipeline/README.md">link to markdown</a> and
<a href="https://giuliostarace.com/nowcastlib/pipeline">link to hosted docs</a>)</p>
<p>Please refer to the
<a href="https://github.com/thesofakillers/nowcastlib/tree/master/examples">examples folder</a>
on GitHub for usage examples.</p>
<h3 id="api">API</h3>
<p>Here is a quick example of how one may import nowcastlib and access to one of
the functions:</p>
<pre><code class="language-python">&quot;&quot;&quot;Example showing how to access compute_trig_fields function&quot;&quot;&quot;
import nowcastlib as ncl
import pandas as pd
import numpy as np

data_df = pd.DataFrame(
    np.array([[0, 3, 4, np.NaN], [32, 4, np.NaN, 4], [56, 8, 0, np.NaN]]).T,
    columns=[&quot;A&quot;, &quot;B&quot;, &quot;C&quot;],
    index=pd.date_range(start=&quot;1/1/2018&quot;, periods=4, freq=&quot;2min&quot;),
)

result = ncl.datasets.compute_trig_fields(data_df, [&quot;A&quot;, &quot;C&quot;])
</code></pre>
<p>More in-depth API documentation can be found
<a href="https://giuliostarace.com/nowcastlib/">here</a>.</p>
<h3 id="cli">CLI</h3>
<p>Some of the library's functionality is bundled in configurable subcommands
accessible via the terminal with the command <code><a title="nowcastlib" href="#nowcastlib">nowcastlib</a></code>:</p>
<pre><code class="language-console">usage: nowcastlib [-h] [-v]
                  {triangulate,preprocess,sync,postprocess,datapipe} ...

positional arguments:
  {triangulate,preprocess,sync,postprocess,datapipe}
                        available commands
    triangulate         Run `nowcastlib triangulate -h` for further help
    preprocess          Run `nowcastlib preprocess -h` for further help
    sync                Run `nowcastlib sync -h` for further help
    postprocess         Run `nowcastlib postprocess -h` for further help
    datapipe            Run `nowcastlib datapipe -h` for further help

optional arguments:
  -h, --help            show this help message and exit
  -v, --verbose         increase verbosity level from INFO to DEBUG
</code></pre>
<h3 id="repository-structure">Repository Structure</h3>
<p>The following output is generated with <code>tree . -I 'dist|docs|*.pyc|__pycache__'</code></p>
<pre><code class="language-bash">.
├── LICENSE
├── Makefile # currently used to build docs
├── README.md
├── de421.bsp # not committed
├── docs/ # html files for the documentation static website
├── examples
│   ├── README.md
│   ├── cli_triangulate_config.yaml
│   ├── data/  # not committed
│   ├── datasync.ipynb
│   ├── output/ # not committed
│   ├── pipeline_datapipe.json
│   ├── pipeline_preprocess.json
│   ├── pipeline_sync.json
│   ├── signals.ipynb
│   └── triangulation.ipynb
├── images
│   └── pipeline_flow.png
├── nowcastlib # the actual source code for the library
│   ├── __init__.py
│   ├── cli
│   │   ├── __init__.py
│   │   └── triangulate.py
│   ├── datasets.py
│   ├── dynlag.py
│   ├── gis.py
│   ├── pipeline
│   │   ├── README.md
│   │   ├── __init__.py
│   │   ├── cli.py
│   │   ├── process
│   │   │   ├── __init__.py
│   │   │   ├── postprocess
│   │   │   │   ├── __init__.py
│   │   │   │   ├── cli.py
│   │   │   │   └── generate.py
│   │   │   ├── preprocess
│   │   │   │   ├── __init__.py
│   │   │   │   └── cli.py
│   │   │   └── utils.py
│   │   ├── split
│   │   │   └── __init__.py
│   │   ├── structs.py
│   │   ├── sync
│   │   │   ├── __init__.py
│   │   │   └── cli.py
│   │   └── utils.py
│   ├── signals.py
│   └── utils.py
├── poetry.lock # lock file generated by python poetry for dependency mgmt
└── pyproject.toml # general information file, handled by python poetry
</code></pre>
<h4 id="directories-and-files-not-committed">Directories and Files not Committed</h4>
<p>There are a number of files and folders that are not committed due to their
large and static nature that renders them inappropriate for git version control.
The following files and folder warrant a brief explanation.</p>
<ul>
<li>Certain functions (time since sunset, sun elevation) of the Nowcast Library
rely on the use of a .bsp file, containing information on the locations
through time of various celestial bodies in the sky. This file will be
automatically downloaded upon using one of these functions for the first
time.</li>
<li>The examples scripts make use of a <code>data/</code> directory containing a series of
csv files. Most of the data used in the examples can be downloaded from the
<a href="http://archive.eso.org/cms/eso-data/ambient-conditions.html">ESO Ambient Condition Database</a>.
Users can then change the paths set in the examples to fit their needs. For
users interested in replicating the exact structure and contents of the data
directory, a compressed copy of it (1.08 GB) is available to ESO members
through
<a href="https://europeansouthernobservatory.sharepoint.com/:u:/t/OpticalTurbulenceandWeatherNowcast/EeH844GlBgdBjc63uaPiO4ABrh7ylH54zH3dJV9WSIhakA?e=gPBWJ7">this Microsoft Sharepoint link</a>.</li>
<li>At times the examples show the serialization functionality of the nowcastlib
pipeline or need to output some data. In these situations the <code>output/</code>
directory in the examples folder is used.</li>
</ul>
<h2 id="development-setup">Development Setup</h2>
<p>This repository relies on <a href="https://python-poetry.org/">Poetry</a> for tracking
dependencies, building and publishing. It is therefore recommended that
developers <a href="https://python-poetry.org/docs/#installation">install poetry</a> and
make use of it throughout their development of the project.</p>
<h3 id="dependencies">Dependencies</h3>
<p>Make sure you are in the right Python environment and run</p>
<pre><code class="language-console">poetry install
</code></pre>
<p>This reads <a href="./pyproject.toml">pyproject.toml</a>, resolves the dependencies, and
installs them.</p>
<h3 id="deployment">Deployment</h3>
<p>The repository is published to <a href="https://pypi.org/">PyPi</a>, so to make it
accessible via a <code>pip install</code> command as mentioned <a href="#install">earlier</a>.</p>
<p>To publish changes follow these steps. Ideally this process is automated via a
CI tool triggered by a push/merge to the master branch:</p>
<ol>
<li>
<p>Optionally run
<a href="https://python-poetry.org/docs/cli/#version"><code>poetry version</code></a> with the
appropriate argument based on <a href="https://semver.org/">semver guidelines</a>.</p>
</li>
<li>
<p>Update the documentation by running</p>
<p><code>console
make document</code></p>
</li>
<li>
<p>Prepare the package by running</p>
<p><code>console
poetry build</code></p>
</li>
<li>
<p>Ensure you have <a href="https://test.pypi.org/">TestPyPi</a> and PyPi configured as
your poetry repositories:</p>
<p><code>console
poetry config repositories.testpypi &lt;https://test.pypi.org/legacy/&gt;
poetry config repositories.pypi &lt;https://pypi.org/&gt;</code></p>
</li>
<li>
<p>Publish the repository to TestPyPi, to see that everything works as expected:</p>
<p><code>console
poetry publish -r testpypi</code></p>
</li>
<li>
<p>Stage, commit and push your changes (to master) with git.</p>
</li>
<li>
<p>Publish the repository to PyPi:</p>
<p><code>console
poetry publish -r pypi</code></p>
</li>
</ol>
<p>Upon successful deployment, the library should be available for install via
<code>pip</code></p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;
.. include:: ../README.md
&#34;&#34;&#34;
import logging
import nowcastlib.datasets
import nowcastlib.gis
import nowcastlib.signals
import nowcastlib.utils
import nowcastlib.dynlag
import nowcastlib.pipeline

try:
    import importlib.metadata as importlib_metadata
except ModuleNotFoundError:
    import importlib_metadata

__version__ = importlib_metadata.version(__name__)

__pdoc__ = {
    &#34;cli&#34;: False,
}


# logging config {{{
root_logger = logging.getLogger(__name__)
root_logger.setLevel(logging.INFO)

logger_formatter = logging.Formatter(&#34;%(asctime)s - %(levelname)s - %(message)s&#34;)

console_handler = logging.StreamHandler()
console_handler.setLevel(logging.INFO)
console_handler.setFormatter(logger_formatter)

root_logger.addHandler(console_handler)
# }}}</code></pre>
</details>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="nowcastlib.datasets" href="datasets.html">nowcastlib.datasets</a></code></dt>
<dd>
<div class="desc"><p>Functions for syncing and chunking multiple datasets.</p></div>
</dd>
<dt><code class="name"><a title="nowcastlib.dynlag" href="dynlag.html">nowcastlib.dynlag</a></code></dt>
<dd>
<div class="desc"><p>Functions for generating dynamically lagged time series.</p></div>
</dd>
<dt><code class="name"><a title="nowcastlib.gis" href="gis.html">nowcastlib.gis</a></code></dt>
<dd>
<div class="desc"><p>Functions for computing metrics related to Geographical information science.</p></div>
</dd>
<dt><code class="name"><a title="nowcastlib.pipeline" href="pipeline/index.html">nowcastlib.pipeline</a></code></dt>
<dd>
<div class="desc"><p>Data processing and Model evaluation pipeline for the Nowcast Library
Pipeline …</p></div>
</dd>
<dt><code class="name"><a title="nowcastlib.signals" href="signals.html">nowcastlib.signals</a></code></dt>
<dd>
<div class="desc"><p>Utils for working with signal processing</p></div>
</dd>
<dt><code class="name"><a title="nowcastlib.utils" href="utils.html">nowcastlib.utils</a></code></dt>
<dd>
<div class="desc"><p>Uncategorised utilities.</p></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul>
<li><a href="#nowcast-library">Nowcast Library</a><ul>
<li><a href="#installation">Installation</a></li>
<li><a href="#usage-and-documentation">Usage and Documentation</a><ul>
<li><a href="#api">API</a></li>
<li><a href="#cli">CLI</a></li>
<li><a href="#repository-structure">Repository Structure</a><ul>
<li><a href="#directories-and-files-not-committed">Directories and Files not Committed</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#development-setup">Development Setup</a><ul>
<li><a href="#dependencies">Dependencies</a></li>
<li><a href="#deployment">Deployment</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<ul id="index">
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="nowcastlib.datasets" href="datasets.html">nowcastlib.datasets</a></code></li>
<li><code><a title="nowcastlib.dynlag" href="dynlag.html">nowcastlib.dynlag</a></code></li>
<li><code><a title="nowcastlib.gis" href="gis.html">nowcastlib.gis</a></code></li>
<li><code><a title="nowcastlib.pipeline" href="pipeline/index.html">nowcastlib.pipeline</a></code></li>
<li><code><a title="nowcastlib.signals" href="signals.html">nowcastlib.signals</a></code></li>
<li><code><a title="nowcastlib.utils" href="utils.html">nowcastlib.utils</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>